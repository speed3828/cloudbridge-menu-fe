# 브랜치 동기화 자동화 시스템 가이드

이 문서는 CloudBridge Menu 프론트엔드 프로젝트의 브랜치 동기화 자동화 시스템 사용법을 설명합니다.

## 1. 자동화의 목적

브랜치 동기화 자동화 시스템은 다음과 같은 목적으로 개발되었습니다:

- 다양한 환경(개발, 스테이징, 프로덕션) 간의 코드 일관성 유지
- 수동 병합 작업으로 인한 휴먼 에러 방지
- 릴리스 및 배포 프로세스 간소화
- 팀 간 협업 효율성 증대

## 2. 주요 기능

### 2.1 GitHub Actions 워크플로우

프로젝트에는 다음과 같은 브랜치 동기화 워크플로우가 구현되어 있습니다:

- **자동 동기화**: `main` 브랜치에 변경사항이 푸시되면 자동으로 `staging` 및 `develop` 브랜치로 동기화
- **수동 동기화**: 개발자가 지정한 브랜치 간 동기화 (GitHub UI를 통해 실행 가능)
- **강제 동기화 옵션**: 충돌 발생 시 강제로 동기화 (주의: 데이터 손실 가능성 있음)

### 2.2 동기화 스크립트

로컬에서 브랜치 동기화를 실행할 수 있는 Node.js 스크립트도 제공됩니다:

```bash
# 기본 사용법 (main → staging)
node scripts/sync-branches.js

# 특정 브랜치 지정 (예: develop → staging)
node scripts/sync-branches.js develop staging

# 강제 동기화 (주의: 대상 브랜치의 고유 변경사항 손실됨)
node scripts/sync-branches.js main staging --force
```

## 3. 사용 방법

### 3.1 GitHub Actions를 통한 동기화

1. GitHub 저장소 페이지로 이동
2. "Actions" 탭 클릭
3. "브랜치 동기화 자동화" 워크플로우 선택
4. "Run workflow" 버튼 클릭
5. 소스 브랜치와 대상 브랜치 선택 (필요 시 강제 동기화 옵션 체크)
6. "Run workflow" 버튼 클릭하여 실행

### 3.2 로컬 스크립트를 통한 동기화

1. 프로젝트 루트 디렉토리로 이동
2. 다음 명령어 실행:

   ```bash
   node scripts/sync-branches.js [소스_브랜치] [대상_브랜치] [--force]
   ```

3. 스크립트가 자동으로 브랜치를 동기화하고 결과를 출력

## 4. 주의사항

- **강제 동기화 주의**: `--force` 옵션은 대상 브랜치의 고유한 변경사항을 모두 삭제합니다.
- **권한 확인**: 원격 저장소에 푸시 권한이 있는지 확인하세요.
- **충돌 해결**: 자동 동기화 중 충돌이 발생하면 워크플로우가 실패합니다. 수동으로 해결해야 합니다.
- **환경별 설정 파일**: 환경별 설정 파일(예: `.env.development`, `.env.staging`)은 별도로 관리해야 합니다.

## 5. 문제 해결

### 5.1 일반적인 오류

1. **권한 오류**: GitHub 토큰에 적절한 권한이 없는 경우 발생
   - 해결: 저장소 설정에서 GitHub Actions 권한 확인

2. **병합 충돌**: 소스와 대상 브랜치 간 충돌 발생
   - 해결: 수동으로 충돌 해결 후 다시 동기화 시도

3. **브랜치 보호 규칙**: 대상 브랜치에 보호 규칙이 설정된 경우
   - 해결: 관리자에게 연락하여 일시적으로 보호 규칙 완화 요청

### 5.2 로그 확인

- GitHub Actions 워크플로우 실행 로그를 통해 오류 확인 가능
- 로컬 스크립트 실행 시 콘솔 출력에서 오류 확인

## 6. 개선 계획

향후 다음과 같은 기능 개선이 계획되어 있습니다:

- 슬랙/Teams 알림 기능 추가
- 동기화 결과 리포트 생성
- 자동 충돌 해결 로직 개선
- 테스트 자동화와의 통합

## 7. 기여 방법

브랜치 동기화 자동화 시스템 개선에 기여하고 싶다면:

1. `automation` 브랜치에서 작업
2. 변경사항 테스트 후 PR 생성
3. 코드 리뷰 진행
4. 승인 후 병합
